#!/bin/bash

# This file was generated by Ansible for {{ ansible_fqdn }}
# Do NOT modify this file by hand!

WORKDIR="{{ backup_work }}/{{ item[0]['name'] }}"

{% if item[0]['docker-container'] is defined %}
DOCKER_CONTAINER="{{ item[0]['docker-container'] }}"
{% else %}
DOCKER_CONTAINER=`docker ps | grep postgres | awk '{ print $(NF); }'`
{% endif %}

cat "${WORKDIR}"/dump | docker exec -i "${DOCKER_COMTAINER}" psql -U postgres

{% for action in item[0]['restore_actions']|default([]) %}
{{ action }}
{% endfor %}
